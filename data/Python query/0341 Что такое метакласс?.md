[query_title]
Что такое метакласс?

[query_title]
Что такое метакласс?

[answer_title]
Ответ №1

[answer_content]
Метакласс в Python - это класс, который определяет поведение других классов. Когда мы определяем класс, интерпретатор Python использует метакласс (по умолчанию - type) для создания этого класса. Метаклассы позволяют изменять поведение классов и их экземпляров, а также добавлять свои собственные методы и атрибуты.

Вот пример метакласса, который добавляет метод custom_method() в класс MyClass:
```py
class MyMeta(type):
    def __new__(cls, name, bases, dct):
        dct['custom_method'] = lambda self: print('Hello, world!')
        return super().__new__(cls, name, bases, dct)

class MyClass(metaclass=MyMeta):
    pass

obj = MyClass()
obj.custom_method()   # output: Hello, world!
```
В этом примере MyMeta является метаклассом , который добавляет метод custom_method() в класс MyClass. Затем мы создаем экземпляр MyClass и вызываем добавленный метод на этом экземпляре, выводя строку "Hello, world!".

Еще один пример использования метаклассов - это создание синглтона, когда мы хотим, чтобы у нас был только один экземпляр класса:
```py
class Singleton(type):
    _instances = {}

    def __call__(cls, *args, **kwargs):
        if cls not in cls._instances:
            cls._instances[cls] = super().__call__(*args, **kwargs)
        return cls._instances[cls]

class MyClass(metaclass=Singleton):
    pass

a = MyClass()
b = MyClass()

print(a is b)   # output: True
```
В этом примере Singleton является метаклассом , который гарантирует, что у нас будет только один экземпляр класса MyClass благодаря словарю _instances. Когда мы создаем
